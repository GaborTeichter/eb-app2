/*! eb-app2 2021-06-04 */

var app=angular.module("app",[]);app.factory("matchFactory",["$http","$q",function(o,c){return{getMatches:function(){var e=c.defer();return o.get("/match/vote").then(function(t){e.resolve(t.data)},function(t){e.reject(t)}),e.promise},getMatchList:function(){var n=this,a=c.defer();return o.get("/match/list").then(function(t){for(var e=0;e<t.data.length;e++)t.data[e].startDate=n.dateStringToDate(t.data[e].startDate);a.resolve(t.data)},function(t){a.reject(t)}),a.promise},getFlags:function(){var e=c.defer();return o.get("json/flag.json").then(function(t){e.resolve(t.data)},function(t){e.reject(t)}),e.promise},createMatch:function(t){var e=c.defer();return o.post("/match/new",t).then(function(t){e.resolve(t.data)},function(t){e.reject(t)}),e.promise},updateMatch:function(t){var e=c.defer();return o.post("/match/update",t).then(function(t){e.resolve(t.data)},function(t){e.reject(t)}),e.promise},deleteMatch:function(t){var e=c.defer();return o.delete("/match/"+t).then(function(t){e.resolve(t.data)},function(t){e.reject(t)}),e.promise},dateStringToDate:function(t){return new Date(new RegExp("(.{4}-.{2}-.{2})").exec(t)[1])},sendVote:function(t){var e=c.defer();return o.post("/match/vote",t).then(function(t){e.resolve(t.data)},function(t){e.reject(t)}),e.promise}}}]),app.factory("teamFactory",["$http","$q",function(n,a){return{getTeamList:function(){var e=a.defer();return n.get("/team/list").then(function(t){e.resolve(t.data)},function(t){e.reject(t)}),e.promise},createTeam:function(t){var e=a.defer();return n.post("/team/new",t).then(function(t){e.resolve(t.data)},function(t){e.reject(t)}),e.promise},updateTeam:function(t){var e=a.defer();return n.post("/team/update",t).then(function(t){e.resolve(t.data)},function(t){e.reject(t)}),e.promise}}}]),app.controller("matchController",["$scope","matchFactory",function(e,n){e.flags={},n.getFlags().then(function(t){console.log("flags",t),e.flags=t,e.getMatches()},function(t){e.matchesError=t}),e.matches=[],e.getMatches=function(){n.getMatches().then(function(t){console.log("matches",t),e.matches=t},function(t){e.matchesError=t})},e.getFlag=function(t){return e.flags[t]},e.sendVote=function(t){n.sendVote(t).then(function(t){console.log(t)})}}]),app.controller("matchHandlerController",["$scope","matchFactory","$timeout","teamFactory",function(e,n,a){e.getMatches=function(){n.getMatchList().then(function(t){console.log(t),e.matchList=t})},e.createMatch=function(t){console.log(t),n.createMatch(t).then(function(t){e.matchCreated=!0,a(function(){e.matchCreated=!1},3e3),e.getMatches(),e.match={}},function(){e.matchCreatedError=!0,a(function(){e.matchCreatedError=!1},3e3)})},e.deleteMatch=function(t){n.deleteMatch(t._id).then(function(t){e.getMatches()})},e.updateMatch=function(t){n.updateMatch(t).then(function(t){e.matchUpdated=!0,a(function(){e.matchUpdated=!1},3e3)},function(){e.matchUpdatedError=!0,a(function(){e.matchUpdatedError=!1},3e3)})},e.getMatches()}]),app.controller("menuController",["$scope","matchFactory",function(t,e){t.appName="EB 2021 szavazÃ¡s",t.currentPage=location.href.replace(location.protocol+"//"+location.host,"")}]),app.controller("teamHandlerController",["$scope","teamFactory","$timeout",function(e,n,a){e.getTeams=function(){n.getTeamList().then(function(t){e.teamList=t})},e.createTeam=function(t){n.createTeam(t).then(function(t){e.matchCreated=!0,a(function(){e.matchCreated=!1},3e3),e.getTeams(),e.team={}},function(){e.matchCreatedError=!0,a(function(){e.matchCreatedError=!1},3e3)})},e.updateTeam=function(t){n.updateTeam(t).then(function(t){e.matchUpdated=!0,a(function(){e.matchUpdated=!1},3e3)},function(){e.matchUpdatedError=!0,a(function(){e.matchUpdatedError=!1},3e3)})},e.getTeams()}]);